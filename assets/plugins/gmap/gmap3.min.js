/*!
 *  GMAP3 Plugin for JQuery
 *  Version   : 5.1.1
 *  Date      : 2013-05-25
 *  Licence   : GPL v3 : http://www.gnu.org/licenses/gpl.html
 *  Author    : DEMONTE Jean-Baptiste
 *  Contact   : jbdemonte@gmail.com
 *  Web site  : http://gmap3.net
 */
(function(h,y){function H(a,d){return a!==y?a:"gmap3_"+(d?Q+1:++Q)}function V(a){var d=function(a){return parseInt(a,10)},e=google.maps.version.split(".").map(d);a=a.split(".").map(d);for(d=0;d<a.length;d++)if(e.hasOwnProperty(d)){if(e[d]<a[d])return!1}else return!1;return!0}function C(a,d,e,c,f){if(d.todo.events||d.todo.onces){var m={id:c,data:d.todo.data,tag:d.todo.tag};d.todo.events&&h.each(d.todo.events,function(d,c){var n=a,l=c;h.isArray(c)&&(n=c[0],l=c[1]);google.maps.event.addListener(e,d,function(a){l.apply(n,[f?f:e,a,m])})});d.todo.onces&&h.each(d.todo.onces,function(d,c){var n=a,l=c;h.isArray(c)&&(n=c[0],l=c[1]);google.maps.event.addListenerOnce(e,d,function(a){l.apply(n,[f?f:e,a,m])})})}}function X(){var a=[];this.empty=function(){return!a.length};this.add=function(d){a.push(d)};this.get=function(){return a.length?a[0]:!1};this.ack=function(){a.shift()}}function Y(a,d,e){function c(a){var f={};f[a]={};return f}function f(){for(var a in e)if(!(a in m))return a}var m={},g=this,l,n={map:!1,marker:!1,infowindow:!1,circle:!1,overlay:!1,getlatlng:!1,getmaxzoom:!1,getelevation:!1,streetviewpanorama:!1,getaddress:!0},F={getgeoloc:!0};"string"===typeof e&&(e=c(e));this.run=function(){for(var c,g;c=f();){if("function"===typeof a[c]){l=c;g=h.extend(!0,{},t[c]||{},e[c].options||{});c in n?e[c].values?Z(e[c].values,a,a[c],{todo:e[c],opts:g,session:m}):L(a,a[c],n[c],{todo:e[c],opts:g,session:m}):c in F?$(a,a[c],{todo:e[c],opts:g,session:m}):a[c].apply(a,[{todo:e[c],opts:g,session:m}]);return}m[c]=null}d.apply(a,[e,m])};this.ack=function(a){m[l]=a;g.run.apply(g,[])}}function R(a){var d,e=[];for(d in a)e.push(d);return e}function D(a,d){var e={};if(a.todo)for(var c in a.todo)"options"!==c&&"values"!==c&&(e[c]=a.todo[c]);var f=["data","tag","id","events","onces"];for(c=0;c<f.length;c++)aa(e,f[c],d,a.todo);e.options=h.extend({},a.opts||{},d.options||{});return e}function aa(a,d){for(var e=2;e<arguments.length;e++)if(d in arguments[e]){a[d]=arguments[e][d];break}}function I(a,d,e,c){var f=this,m=[];t.classes.OverlayView.call(this);this.setMap(a);this.onAdd=function(){var a=this.getPanes();d.pane in a&&h(a[d.pane]).append(c);h.each("dblclick click mouseover mousemove mouseout mouseup mousedown".split(" "),function(a,e){m.push(google.maps.event.addDomListener(c[0],e,function(a){h.Event(a).stopPropagation();google.maps.event.trigger(f,e,[a]);f.draw()}))});m.push(google.maps.event.addDomListener(c[0],"contextmenu",function(a){h.Event(a).stopPropagation();google.maps.event.trigger(f,"rightclick",[a]);f.draw()}))};this.getPosition=function(){return e};this.draw=function(){var a=this.getProjection().fromLatLngToDivPixel(e);c.css("left",a.x+d.offset.x+"px").css("top",a.y+d.offset.y+"px")};this.onRemove=function(){for(var a=0;a<m.length;a++)google.maps.event.removeListener(m[a]);c.remove()};this.hide=function(){c.hide()};this.show=function(){c.show()};this.toggle=function(){c&&(c.is(":visible")?this.show():this.hide())};this.toggleDOM=function(){this.getMap()?this.setMap(null):this.setMap(a)};this.getDOMElement=function(){return c[0]}}function ba(a,d){function e(){this.onAdd=function(){};this.onRemove=function(){};this.draw=function(){};return t.classes.OverlayView.apply(this,[])}e.prototype=t.classes.OverlayView.prototype;var c=new e;c.setMap(a);return c}function ca(a,d,e){function c(b){p[b]||(delete v[b].options.map,p[b]=new t.classes.Marker(v[b].options),C(a,{todo:v[b]},p[b],v[b].id))}function f(){(A=y.getProjection())?(B=!0,s.push(google.maps.event.addListener(d,"zoom_changed",function(){n()})),s.push(google.maps.event.addListener(d,"bounds_changed",function(){n()})),q()):setTimeout(function(){f.apply(G,[])},25)}function m(b){"object"===typeof u[b]?("function"===typeof u[b].obj.setMap&&u[b].obj.setMap(null),"function"===typeof u[b].obj.remove&&u[b].obj.remove(),"function"===typeof u[b].shadow.remove&&u[b].obj.remove(),"function"===typeof u[b].shadow.setMap&&u[b].shadow.setMap(null),delete u[b].obj,delete u[b].shadow):p[b]&&p[b].setMap(null);delete u[b]}function g(){var b;b=d.getCenter();var a=d.getBounds().getNorthEast(),f,B;b instanceof google.maps.LatLng?(f=b.lat(),B=b.lng(),a instanceof google.maps.LatLng?(b=a.lat(),a=a.lng()):(b=a,a=void 0)):(f=b,B=a,a=b=void 0);f=Math.PI*f/180;B=Math.PI*B/180;b=Math.PI*b/180;a=Math.PI*a/180;b=6371E3*Math.acos(Math.min(Math.cos(f)*Math.cos(b)*Math.cos(B)*Math.cos(a)+Math.cos(f)*Math.sin(B)*Math.cos(b)*Math.sin(a)+Math.sin(f)*Math.sin(b),1));return(new google.maps.Circle({center:d.getCenter(),radius:1.25*b})).getBounds()}function l(){var b={},a;for(a in u)b[a]=!0;return b}function n(){clearTimeout(z);z=setTimeout(function(){q()},25)}function F(b){var a=A.fromLatLngToDivPixel(b);b=A.fromDivPixelToLatLng(new google.maps.Point(a.x+e.radius,a.y-e.radius));a=A.fromDivPixelToLatLng(new google.maps.Point(a.x-e.radius,a.y+e.radius));return new google.maps.LatLngBounds(a,b)}function q(){if(!r&&!b&&B){var a=[],f={},c=d.getZoom(),k="maxZoom"in e&&c>e.maxZoom,G=l(),p,s;s=!1;var w,n,q;x=!1;3<c&&(w=g(),s=w.getSouthWest().lng()<w.getNorthEast().lng());for(c=0;c<v.length;c++)!v[c]||s&&!w.contains(v[c].options.position)||M&&!M(E[c])||a.push(c);for(;;){for(c=0;f[c]&&c<a.length;)c++;if(c==a.length)break;s=[];if(N&&!k){q=10;do for(n=s,s=[],q--,w=n.length?w.getCenter():v[a[c]].options.position,w=F(w),p=c;p<a.length;p++)f[p]||w.contains(v[a[p]].options.position)&&s.push(p);while(n.length<s.length&&1<s.length&&q)}else for(p=c;p<a.length;p++)if(!f[p]){s.push(p);break}n={indexes:[],ref:[]};for(c=q=p=0;c<s.length;c++)f[s[c]]=!0,n.indexes.push(a[s[c]]),n.ref.push(a[s[c]]),q+=v[a[s[c]]].options.position.lat(),p+=v[a[s[c]]].options.position.lng();q/=s.length;p/=s.length;n.latLng=new google.maps.LatLng(q,p);n.ref=n.ref.join("-");n.ref in G?delete G[n.ref]:(1===s.length&&(u[n.ref]=!0),D(n))}h.each(G,function(b){m(b)});b=!1}}var r=!1,x=!1,b=!1,B=!1,N=!0,G=this,s=[],u={},w={},k={},p=[],v=[],E=[],y=ba(d,e.radius),z,A,M,D;f();this.getById=function(b){return b in w?(c(w[b]),p[w[b]]):!1};this.rm=function(b){var a=w[b];p[a]&&p[a].setMap(null);delete p[a];p[a]=!1;delete v[a];v[a]=!1;delete E[a];E[a]=!1;delete w[b];delete k[a];x=!0};this.clearById=function(b){if(b in w)return this.rm(b),!0};this.clear=function(b,a,f){var c,B,e=[],d=J(f);b?(c=v.length-1,B=f=-1):(c=0,f=v.length,B=1);for(;c!=f&&(!v[c]||d&&!d(v[c].tag)||(e.push(k[c]),!a&&!b));c+=B);for(b=0;b<e.length;b++)this.rm(e[b])};this.add=function(b,a){b.id=H(b.id);this.clearById(b.id);w[b.id]=p.length;k[p.length]=b.id;p.push(null);v.push(b);E.push(a);x=!0};this.addMarker=function(b,c){c=c||{};c.id=H(c.id);this.clearById(c.id);c.options||(c.options={});c.options.position=b.getPosition();C(a,{todo:c},b,c.id);w[c.id]=p.length;k[p.length]=c.id;p.push(b);v.push(c);E.push(c.data||{});x=!0};this.todo=function(b){return v[b]};this.value=function(b){return E[b]};this.marker=function(b){return b in p?(c(b),p[b]):!1};this.markerIsSet=function(b){return Boolean(p[b])};this.setMarker=function(b,a){p[b]=a};this.store=function(b,a,c){u[b.ref]={obj:a,shadow:c}};this.free=function(){for(var b=0;b<s.length;b++)google.maps.event.removeListener(s[b]);s=[];h.each(u,function(b){m(b)});u={};h.each(v,function(b){v[b]=null});v=[];h.each(p,function(b){p[b]&&(p[b].setMap(null),delete p[b])});p=[];h.each(E,function(b){delete E[b]});E=[];w={};k={}};this.filter=function(b){M=b;q()};this.enable=function(b){N!=b&&(N=b,q())};this.display=function(b){D=b};this.error=function(b){};this.beginUpdate=function(){r=!0};this.endUpdate=function(){r=!1;x&&q()};this.autofit=function(b){for(var a=0;a<v.length;a++)v[a]&&b.extend(v[a].options.position)}}function O(a,d){this.id=function(){return a};this.filter=function(a){d.filter(a)};this.enable=function(){d.enable(!0)};this.disable=function(){d.enable(!1)};this.add=function(a,c,f){f||d.beginUpdate();d.addMarker(a,c);f||d.endUpdate()};this.getById=function(a){return d.getById(a)};this.clearById=function(a,c){var f;c||d.beginUpdate();f=d.clearById(a);c||d.endUpdate();return f};this.clear=function(a,c,f,m){m||d.beginUpdate();d.clear(a,c,f);m||d.endUpdate()}}function da(){function a(a){return{id:a.id,name:a.name,object:a.obj,tag:a.tag,data:a.data}}function d(a){"function"===typeof a.setMap&&a.setMap(null);"function"===typeof a.remove&&a.remove();"function"===typeof a.free&&a.free()}var e={},c={};this.add=function(a,d,g,h){a=a.todo||{};var n=H(a.id);e[d]||(e[d]=[]);n in c&&this.clearById(n);c[n]={obj:g,sub:h,name:d,id:n,tag:a.tag,data:a.data};e[d].push(n);return n};this.getById=function(f,d,e){return f in c?d?c[f].sub:e?a(c[f]):c[f].obj:!1};this.get=function(f,d,g,h){var n,l=J(g);if(!e[f]||!e[f].length)return null;for(g=e[f].length;g;)if(g--,(n=e[f][d?g:e[f].length-g-1])&&c[n]&&(!l||l(c[n].tag)))return h?a(c[n]):c[n].obj;return null};this.all=function(f,d,g){var h=[],n=J(d);d=function(f){var d,m;for(d=0;d<e[f].length;d++)(m=e[f][d])&&c[m]&&(!n||n(c[m].tag))&&h.push(g?a(c[m]):c[m].obj)};if(f in e)d(f);else if(f===y)for(f in e)d(f);return h};this.rm=function(a,d,g){var h;if(!e[a])return!1;if(d)if(g)for(g=e[a].length-1;0<=g&&(h=e[a][g],!d(c[h].tag));g--);else for(g=0;g<e[a].length&&(h=e[a][g],!d(c[h].tag));g++);else g=g?e[a].length-1:0;return g in e[a]?this.clearById(e[a][g],g):!1};this.clearById=function(a,m){if(a in c){var g,h=c[a].name;for(g=0;m===y&&g<e[h].length;g++)a===e[h][g]&&(m=g);d(c[a].obj);c[a].sub&&d(c[a].sub);delete c[a];e[h].splice(m,1);return!0}return!1};this.objGetById=function(a){var d;if(e.clusterer)for(var g in e.clusterer)if(!1!==(d=c[e.clusterer[g]].obj.getById(a)))return d;return!1};this.objClearById=function(a){if(e.clusterer)for(var d in e.clusterer)if(c[e.clusterer[d]].obj.clearById(a))return!0;return null};this.clear=function(a,c,d,h){var n,l;h=J(h);if(a&&a.length)a=A(a);else for(n in a=[],e)a.push(n);for(n=0;n<a.length;n++)if(l=a[n],c)this.rm(l,h,!0);else if(d)this.rm(l,h,!1);else for(;this.rm(l,h,!1););};this.objClear=function(a,d,g,l){if(e.clusterer&&(0<=h.inArray("marker",a)||!a.length))for(var n in e.clusterer)c[e.clusterer[n]].obj.clear(d,g,l)}}function S(){z.elevationService||(z.elevationService=new google.maps.ElevationService);return z.elevationService}function T(){if(t.verbose){var a,d=[];if(window.console&&"function"===typeof console.error){for(a=0;a<arguments.length;a++)d.push(arguments[a]);console.error.apply(console,d)}else{d="";for(a=0;a<arguments.length;a++)d+=arguments[a].toString()+" ";alert(d)}}}function P(a){return("number"===typeof a||"string"===typeof a)&&""!==a&&!isNaN(a)}function A(a){var d,e=[];if(a!==y)if("object"===typeof a)if("number"===typeof a.length)e=a;else for(d in a)e.push(a[d]);else e.push(a);return e}function J(a){if(a){if("function"===typeof a)return a;a=A(a);return function(d){if(d===y)return!1;if("object"===typeof d){for(var e=0;e<d.length;e++)if(0<=h.inArray(d[e],a))return!0;return!1}return 0<=h.inArray(d,a)}}}function l(a,d,e){d=d?a:null;return a&&"string"!==typeof a?a.latLng?l(a.latLng):a instanceof google.maps.LatLng?a:P(a.lat)?new google.maps.LatLng(a.lat,a.lng):!e&&h.isArray(a)?P(a[0])&&P(a[1])?new google.maps.LatLng(a[0],a[1]):d:d:d}function K(a){var d,e;if(!a||a instanceof google.maps.LatLngBounds)return a||null;h.isArray(a)?2==a.length?(d=l(a[0]),e=l(a[1])):4==a.length&&(d=l([a[0],a[1]]),e=l([a[2],a[3]])):"ne"in a&&"sw"in a?(d=l(a.ne),e=l(a.sw)):"n"in a&&"e"in a&&"s"in a&&"w"in a&&(d=l([a.n,a.e]),e=l([a.s,a.w]));return d&&e?new google.maps.LatLngBounds(e,d):null}function L(a,d,e,c,f){var h=e?l(c.todo,!1,!0):!1,g=h?{latLng:h}:c.todo.address?"string"===typeof c.todo.address?{address:c.todo.address}:c.todo.address:!1,h=g?U.get(g):!1,y=this;g?(f=f||0,h?(c.latLng=h.results[0].geometry.location,c.results=h.results,c.status=h.status,d.apply(a,[c])):(g.location&&(g.location=l(g.location)),g.bounds&&(g.bounds=K(g.bounds)),z.geocoder||(z.geocoder=new google.maps.Geocoder),z.geocoder.geocode(g,function(h,l){l===google.maps.GeocoderStatus.OK?(U.store(g,{results:h,status:l}),c.latLng=h[0].geometry.location,c.results=h,c.status=l,d.apply(a,[c])):l===google.maps.GeocoderStatus.OVER_QUERY_LIMIT&&f<t.queryLimit.attempt?setTimeout(function(){L.apply(y,[a,d,e,c,f+1])},t.queryLimit.delay+Math.floor(Math.random()*t.queryLimit.random)):(T("geocode failed",l,g),c.latLng=c.results=!1,c.status=l,d.apply(a,[c]))}))):(c.latLng=l(c.todo,!1,!0),d.apply(a,[c]))}function Z(a,d,e,c){function f(){do g++;while(g<a.length&&!("address"in a[g]));g>=a.length?e.apply(d,[c]):L(l,function(c){delete c.todo;h.extend(a[g],c);f.apply(l,[])},!0,{todo:a[g]})}var l=this,g=-1;f()}function $(a,d,e){var c=!1;navigator&&navigator.geolocation?navigator.geolocation.getCurrentPosition(function(f){c||(c=!0,e.latLng=new google.maps.LatLng(f.coords.latitude,f.coords.longitude),d.apply(a,[e]))},function(){c||(c=!0,e.latLng=!1,d.apply(a,[e]))},e.opts.getCurrentPosition):(e.latLng=!1,d.apply(a,[e]))}function ea(a){function d(){!x&&(x=F.get())&&x.run()}function e(){x=null;F.ack();d.call(n)}function c(b){if(b.todo.callback){var c=Array.prototype.slice.call(arguments,1);"function"===typeof b.todo.callback?b.todo.callback.apply(a,c):h.isArray(b.todo.callback)&&"function"===typeof b.todo.callback[1]&&b.todo.callback[1].apply(b.todo.callback[0],c)}}function f(b,d,e){e&&C(a,b,d,e);c(b,d);x.ack(d)}function m(b,c){c=c||{};if(r)c.todo&&c.todo.options&&(c.todo.options.center&&(c.todo.options.center=l(c.todo.options.center)),r.setOptions(c.todo.options));else{var d=c.opts||h.extend(!0,{},t.map,c.todo&&c.todo.options?c.todo.options:{});d.center=b||l(d.center);r=new t.classes.Map(a.get(0),d)}}function g(b,c,d){var e=[],s="values"in b.todo;s||(b.todo.values=[{options:b.opts}]);b.todo.values.length?(m(),h.each(b.todo.values,function(f,s){var k,p,g=D(b,s);if(g.options[d])if(g.options[d][0][0]&&h.isArray(g.options[d][0][0]))for(k=0;k<g.options[d].length;k++)for(p=0;p<g.options[d][k].length;p++)g.options[d][k][p]=l(g.options[d][k][p]);else for(k=0;k<g.options[d].length;k++)g.options[d][k]=l(g.options[d][k]);g.options.map=r;p=new google.maps[c](g.options);e.push(p);k=q.add({todo:g},c.toLowerCase(),p);C(a,{todo:g},p,k)}),f(b,s?e:e[0])):f(b,!1)}function W(b){var c=new ca(a,r,b),d={},e={},f=[],g=/^[0-9]+$/,w,k;for(k in b)g.test(k)?(f.push(1*k),e[k]=b[k],e[k].width=e[k].width||0,e[k].height=e[k].height||0):d[k]=b[k];f.sort(function(b,a){return b>a});w=d.calculator?function(b){var e=[];h.each(b,function(b,a){e.push(c.value(a))});return d.calculator.apply(a,[e])}:function(b){return b.length};c.error(function(){T.apply(n,arguments)});c.display(function(k){var g,u,m,q;m=w(k.indexes);if(b.force||1<m)for(g=0;g<f.length;g++)f[g]<=m&&(u=e[f[g]]);u?(q=u.offset||[-u.width/2,-u.height/2],g=h.extend({},d),g.options=h.extend({pane:"overlayLayer",content:u.content?u.content.replace("CLUSTER_COUNT",m):"",offset:{x:("x"in q?q.x:q[0])||0,y:("y"in q?q.y:q[1])||0}},d.options||{}),m=n.overlay({todo:g,opts:g.options,latLng:l(k)},!0),g.options.pane="floatShadow",g.options.content=h(document.createElement("div")).width(u.width+"px").height(u.height+"px").css({cursor:"pointer"}),shadow=n.overlay({todo:g,opts:g.options,latLng:l(k)},!0),d.data={latLng:l(k),markers:[]},h.each(k.indexes,function(b,a){d.data.markers.push(c.value(a));c.markerIsSet(a)&&c.marker(a).setMap(null)}),C(a,{todo:d},shadow,y,{main:m,shadow:shadow}),c.store(k,m,shadow)):h.each(k.indexes,function(b,a){c.marker(a).setMap(r)})});return c}var n=this,F=new X,q=new da,r=null,x;this._plan=function(b){for(var a=0;a<b.length;a++)F.add(new Y(n,e,b[a]));d()};this.map=function(b){m(b.latLng,b);C(a,b,r);f(b,r)};this.destroy=function(b){q.clear();a.empty();r&&(r=null);f(b,!0)};this.infowindow=function(b){var c=[],d="values"in b.todo;d||(b.latLng&&(b.opts.position=b.latLng),b.todo.values=[{options:b.opts}]);h.each(b.todo.values,function(e,f){var g,h,k=D(b,f);k.options.position=k.options.position?l(k.options.position):l(f.latLng);r||m(k.options.position);(h=new t.classes.InfoWindow(k.options))&&(k.open===y||k.open)&&(d?h.open(r,k.anchor?k.anchor:y):h.open(r,k.anchor?k.anchor:b.latLng?y:b.session.marker?b.session.marker:y));c.push(h);g=q.add({todo:k},"infowindow",h);C(a,{todo:k},h,g)});f(b,d?c:c[0])};this.circle=function(b){var c=[],d="values"in b.todo;d||(b.opts.center=b.latLng||l(b.opts.center),b.todo.values=[{options:b.opts}]);b.todo.values.length?(h.each(b.todo.values,function(d,e){var f,g,k=D(b,e);k.options.center=k.options.center?l(k.options.center):l(e);r||m(k.options.center);k.options.map=r;g=new t.classes.Circle(k.options);c.push(g);f=q.add({todo:k},"circle",g);C(a,{todo:k},g,f)}),f(b,d?c:c[0])):f(b,!1)};this.overlay=function(b,c){var d=[],e="values"in b.todo;e||(b.todo.values=[{latLng:b.latLng,options:b.opts}]);if(b.todo.values.length){I.__initialised||(I.prototype=new t.classes.OverlayView,I.__initialised=!0);h.each(b.todo.values,function(e,f){var g,k,p=D(b,f);g=h(document.createElement("div")).css({border:"none",borderWidth:"0px",position:"absolute"});g.append(p.options.content);k=new I(r,p.options,l(p)||l(f),g);d.push(k);c||(g=q.add(b,"overlay",k),C(a,{todo:p},k,g))});if(c)return d[0];f(b,e?d:d[0])}else f(b,!1)};this.getaddress=function(b){c(b,b.results,b.status);x.ack()};this.getlatlng=function(b){c(b,b.results,b.status);x.ack()};this.getmaxzoom=function(b){z.maxZoomService||(z.maxZoomService=new google.maps.MaxZoomService);z.maxZoomService.getMaxZoomAtLatLng(b.latLng,function(a){c(b,a.status===google.maps.MaxZoomStatus.OK?a.zoom:!1,status);x.ack()})};this.getelevation=function(b){var a,d=[],e=function(a,d){c(b,d===google.maps.ElevationStatus.OK?a:!1,d);x.ack()};if(b.latLng)d.push(b.latLng);else for(d=A(b.todo.locations||[]),a=0;a<d.length;a++)d[a]=l(d[a]);if(d.length)S().getElevationForLocations({locations:d},e);else{if(b.todo.path&&b.todo.path.length)for(a=0;a<b.todo.path.length;a++)d.push(l(b.todo.path[a]));d.length?S().getElevationAlongPath({path:d,samples:b.todo.samples},e):x.ack()}};this.defaults=function(b){h.each(b.todo,function(b,a){t[b]="object"===typeof t[b]?h.extend({},t[b],a):a});x.ack(!0)};this.rectangle=function(b){var c=[],d="values"in b.todo;d||(b.todo.values=[{options:b.opts}]);b.todo.values.length?(h.each(b.todo.values,function(d,e){var f,g,k=D(b,e);k.options.bounds=k.options.bounds?K(k.options.bounds):K(e);r||m(k.options.bounds.getCenter());k.options.map=r;g=new t.classes.Rectangle(k.options);c.push(g);f=q.add({todo:k},"rectangle",g);C(a,{todo:k},g,f)}),f(b,d?c:c[0])):f(b,!1)};this.polyline=function(b){g(b,"Polyline","path")};this.polygon=function(b){g(b,"Polygon","paths")};this.trafficlayer=function(b){m();var a=q.get("trafficlayer");a||(a=new t.classes.TrafficLayer,a.setMap(r),q.add(b,"trafficlayer",a));f(b,a)};this.bicyclinglayer=function(b){m();var a=q.get("bicyclinglayer");a||(a=new t.classes.BicyclingLayer,a.setMap(r),q.add(b,"bicyclinglayer",a));f(b,a)};this.groundoverlay=function(b){b.opts.bounds=K(b.opts.bounds);b.opts.bounds&&m(b.opts.bounds.getCenter());var a,c=new t.classes.GroundOverlay(b.opts.url,b.opts.bounds,b.opts.opts);c.setMap(r);a=q.add(b,"groundoverlay",c);f(b,c,a)};this.streetviewpanorama=function(b){b.opts.opts||(b.opts.opts={});b.latLng?b.opts.opts.position=b.latLng:b.opts.opts.position&&(b.opts.opts.position=l(b.opts.opts.position));b.todo.divId?b.opts.container=document.getElementById(b.todo.divId):b.opts.container&&(b.opts.container=h(b.opts.container).get(0));var a,c=new t.classes.StreetViewPanorama(b.opts.container,b.opts.opts);c&&r.setStreetView(c);a=q.add(b,"streetviewpanorama",c);f(b,c,a)};this.kmllayer=function(b){var c=[],d="values"in b.todo;d||(b.todo.values=[{options:b.opts}]);b.todo.values.length?(h.each(b.todo.values,function(d,e){var f,g,k=D(b,e);r||m();f=k.options;k.options.opts&&(f=k.options.opts,k.options.url&&(f.url=k.options.url));f.map=r;g=V("3.10")?new t.classes.KmlLayer(f):new t.classes.KmlLayer(f.url,f);c.push(g);f=q.add({todo:k},"kmllayer",g);C(a,{todo:k},g,f)}),f(b,d?c:c[0])):f(b,!1)};this.panel=function(b){m();var c,d=c=0,e,g=h(document.createElement("div"));g.css({position:"absolute",zIndex:1E3,visibility:"hidden"});b.opts.content&&(e=h(b.opts.content),g.append(e),a.first().prepend(g),b.opts.left!==y?c=b.opts.left:b.opts.right!==y?c=a.width()-e.width()-b.opts.right:b.opts.center&&(c=(a.width()-e.width())/2),b.opts.top!==y?d=b.opts.top:b.opts.bottom!==y?d=a.height()-e.height()-b.opts.bottom:b.opts.middle&&(d=(a.height()-e.height())/2),g.css({top:d,left:c,visibility:"visible"}));c=q.add(b,"panel",g);f(b,g,c)};this.marker=function(b){var c="values"in b.todo,d=!r;c||(b.opts.position=b.latLng||l(b.opts.position),b.todo.values=[{options:b.opts}]);if(b.todo.values.length)if(d&&m(),b.todo.cluster&&!r.getBounds())google.maps.event.addListenerOnce(r,"bounds_changed",function(){n.marker.apply(n,[b])});else if(b.todo.cluster){var e;b.todo.cluster instanceof O?(c=b.todo.cluster,e=q.getById(c.id(),!0)):(e=W(b.todo.cluster),c=new O(H(b.todo.id,!0),e),q.add(b,"clusterer",c,e));e.beginUpdate();h.each(b.todo.values,function(a,c){var f=D(b,c);f.options.position=f.options.position?l(f.options.position):l(c);f.options.map=r;d&&(r.setCenter(f.options.position),d=!1);e.add(f,c)});e.endUpdate();f(b,c)}else{var g=[];h.each(b.todo.values,function(c,e){var f,h,m=D(b,e);m.options.position=m.options.position?l(m.options.position):l(e);m.options.map=r;d&&(r.setCenter(m.options.position),d=!1);h=new t.classes.Marker(m.options);g.push(h);f=q.add({todo:m},"marker",h);C(a,{todo:m},h,f)});f(b,c?g:g[0])}else f(b,!1)};this.getroute=function(b){b.opts.origin=l(b.opts.origin,!0);b.opts.destination=l(b.opts.destination,!0);z.directionsService||(z.directionsService=new google.maps.DirectionsService);z.directionsService.route(b.opts,function(a,d){c(b,d==google.maps.DirectionsStatus.OK?a:!1,d);x.ack()})};this.directionsrenderer=function(b){b.opts.map=r;var a,c=new google.maps.DirectionsRenderer(b.opts);b.todo.divId?c.setPanel(document.getElementById(b.todo.divId)):b.todo.container&&c.setPanel(h(b.todo.container).get(0));a=q.add(b,"directionsrenderer",c);f(b,c,a)};this.getgeoloc=function(b){f(b,b.latLng)};this.styledmaptype=function(b){m();var a=new t.classes.StyledMapType(b.todo.styles,b.opts);r.mapTypes.set(b.todo.id,a);f(b,a)};this.imagemaptype=function(b){m();var a=new t.classes.ImageMapType(b.opts);r.mapTypes.set(b.todo.id,a);f(b,a)};this.autofit=function(b){var a=new google.maps.LatLngBounds;h.each(q.all(),function(b,c){c.getPosition?a.extend(c.getPosition()):c.getBounds?(a.extend(c.getBounds().getNorthEast()),a.extend(c.getBounds().getSouthWest())):c.getPaths?c.getPaths().forEach(function(b){b.forEach(function(b){a.extend(b)})}):c.getPath?c.getPath().forEach(function(b){a.extend(b)}):c.getCenter?a.extend(c.getCenter()):c instanceof O&&(c=q.getById(c.id(),!0))&&c.autofit(a)});a.isEmpty()||r.getBounds()&&r.getBounds().equals(a)||("maxZoom"in b.todo&&google.maps.event.addListenerOnce(r,"bounds_changed",function(){this.getZoom()>b.todo.maxZoom&&this.setZoom(b.todo.maxZoom)}),r.fitBounds(a));f(b,!0)};this.clear=function(b){if("string"===typeof b.todo){if(q.clearById(b.todo)||q.objClearById(b.todo)){f(b,!0);return}b.todo={name:b.todo}}b.todo.id?h.each(A(b.todo.id),function(b,a){q.clearById(a)||q.objClearById(a)}):(q.clear(A(b.todo.name),b.todo.last,b.todo.first,b.todo.tag),q.objClear(A(b.todo.name),b.todo.last,b.todo.first,b.todo.tag));f(b,!0)};this.exec=function(b){var c=this;h.each(A(b.todo.func),function(d,e){h.each(c.get(b.todo,!0,b.todo.hasOwnProperty("full")?b.todo.full:!0),function(b,c){e.call(a,c)})});f(b,!0)};this.get=function(b,a,c){var d,e,g=a?b:b.todo;a||(c=g.full);"string"===typeof g?(e=q.getById(g,!1,c)||q.objGetById(g),!1===e&&(d=g,g={})):d=g.name;"map"===d&&(e=r);e||(e=[],g.id?(h.each(A(g.id),function(b,a){e.push(q.getById(a,!1,c)||q.objGetById(a))}),h.isArray(g.id)||(e=e[0])):(h.each(d?A(d):[y],function(b,a){var d;g.first?(d=q.get(a,!1,g.tag,c))&&e.push(d):g.all?h.each(q.all(a,g.tag,c),function(a,b){e.push(b)}):(d=q.get(a,!0,g.tag,c))&&e.push(d)}),g.all||h.isArray(d)||(e=e[0])));e=h.isArray(e)||!g.all?e:[e];if(a)return e;f(b,e)};this.getdistance=function(b){var a;b.opts.origins=A(b.opts.origins);for(a=0;a<b.opts.origins.length;a++)b.opts.origins[a]=l(b.opts.origins[a],!0);b.opts.destinations=A(b.opts.destinations);for(a=0;a<b.opts.destinations.length;a++)b.opts.destinations[a]=l(b.opts.destinations[a],!0);z.distanceMatrixService||(z.distanceMatrixService=new google.maps.DistanceMatrixService);z.distanceMatrixService.getDistanceMatrix(b.opts,function(a,d){c(b,d===google.maps.DistanceMatrixStatus.OK?a:!1,d);x.ack()})};this.trigger=function(a){if("string"===typeof a.todo)google.maps.event.trigger(r,a.todo);else{var d=[r,a.todo.eventName];a.todo.var_args&&h.each(a.todo.var_args,function(a,b){d.push(b)});google.maps.event.trigger.apply(google.maps.event,d)}c(a);x.ack()}}function fa(a){var d;if("object"===!typeof a||!a.hasOwnProperty("get"))return!1;for(d in a)if("get"!==d)return!1;return!a.get.hasOwnProperty("callback")}var t,Q=0,z={},U=new function(){var a=[];this.get=function(d){if(a.length){var e,c,f,h,g,l=R(d);for(e=0;e<a.length;e++){h=a[e];g=l.length==h.keys.length;for(c=0;c<l.length&&g;c++)f=l[c],(g=f in h.request)&&(g="object"===typeof d[f]&&"equals"in d[f]&&"function"===typeof d[f]?d[f].equals(h.request[f]):d[f]===h.request[f]);if(g)return h.results}}};this.store=function(d,e){a.push({request:d,keys:R(d),results:e})}};h.fn.gmap3=function(){var a,d=[],e=[];t||(t={verbose:!1,queryLimit:{attempt:5,delay:250,random:250},classes:{Map:google.maps.Map,Marker:google.maps.Marker,InfoWindow:google.maps.InfoWindow,Circle:google.maps.Circle,Rectangle:google.maps.Rectangle,OverlayView:google.maps.OverlayView,StreetViewPanorama:google.maps.StreetViewPanorama,KmlLayer:google.maps.KmlLayer,TrafficLayer:google.maps.TrafficLayer,BicyclingLayer:google.maps.BicyclingLayer,GroundOverlay:google.maps.GroundOverlay,StyledMapType:google.maps.StyledMapType,ImageMapType:google.maps.ImageMapType},map:{mapTypeId:google.maps.MapTypeId.ROADMAP,center:[46.578498,2.457275],zoom:2},overlay:{pane:"floatPane",content:"",offset:{x:0,y:0}},geoloc:{getCurrentPosition:{maximumAge:6E4,timeout:5E3}}});for(a=0;a<arguments.length;a++)arguments[a]&&d.push(arguments[a]);d.length||d.push("map");h.each(this,function(){var a=h(this),f=a.data("gmap3");f||(f=new ea(a),a.data("gmap3",f));1!==d.length||"get"!==d[0]&&!fa(d[0])?f._plan(d):"get"===d[0]?e.push(f.get("map",!0)):e.push(f.get(d[0].get,!0,d[0].get.full))});return e.length?1===e.length?e[0]:e:this}})(jQuery);